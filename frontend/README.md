> **请结合代码实际**
>

# 运维信息表 (OpsBoard) - Design Prototype
这个项目的本意是为了能帮我在工作中偷懒`(jie sheng shi jian)`。   
拖了很长时间终于开始着手准备了，先做前端就是因为还没想好怎么设计数据库和后端。  
即使到现在，这个项目仍然没有确定数据库字段啥的要怎么设计，甚至我现在都还没想好后端用Rust还是Java。  
感谢Google AI Studio以及谷歌的Gemini 2.5 Pro模型帮助我完成这个项目。

## 项目概述

运维信息表 (OpsBoard) 是一个基于 **React 18** 和 **Material-UI (MUI)** 构建的、功能完备的现代化单页应用 (SPA) 模板。  
它不仅仅是一个运维管理平台，更是一个展示如何在真实项目中集成**响应式布局、模块化 API、全局状态管理、统一错误处理和自动化测试**等最佳实践的“活文档”。

### 核心特性

-   **极致的响应式设计**: 从桌面端的多面板布局到移动端的全屏视图，UI 完美适配所有设备。
-   **URL 驱动的状态管理**: 详情弹窗、页面参数等核心状态由 URL 驱动，支持链接分享和浏览器历史记录。
-   **组件化与模块化**: 遵循严格的关注点分离原则，拥有清晰的组件、布局、页面和工具函数分层。
-   **强大的错误处理机制**: 集成了**全局错误边界**和**统一的 API 错误处理**，确保应用永不白屏，并提供清晰的用户反馈。
-   **自动化测试基石**: 已集成 **Jest** 和 **React Testing Library**，为核心功能和组件的质量保驾護航。
-   **现代化 TypeScript 实践**: 全项目采用最新的组件写法 (移除 `React.FC`)，提供更精确、更安全的类型定义。
-   **流畅的动画体验**: 基于 **Framer Motion** 构建的、符合物理直觉的页面过渡和组件动画。

## Material Design 哲学与用户感知细节

本项目深度集成了 Material Design 3 (MD3) 的设计原则，并利用 MUI 强大的定制能力，旨在创造一个不仅功能强大，而且在视觉和交互上都直观、愉悦的用户体验。

### 1. **光影、层次与空间 (Light, Surface & Elevation)**
- **Z轴感知**: 我们通过微妙的阴影变化来区分 UI 元素的层级。例如，展开的 `SideNav` 和浮动的 `RightSearchPanel` 拥有轻微的 `box-shadow`，使其在视觉上“浮”在主内容区之上，清晰地界定了功能区域。
- **动态高程**: 交互元素在不同状态下会改变其“高程”。例如，按钮在悬停 (`:hover`) 时，背景色会变深（如 `app.button.hover`），模拟了手指靠近时，光线被遮挡的效果，为用户提供了即时的物理反馈。

### 2. **动画与动态效果 (Motion & Animation)**
- **有意义的过渡**: 所有的动画都不是为了炫技，而是为了引导用户的注意力并解释 UI 的变化。
    - **页面切换**: `pageVariants` 动画采用“淡入并上移”的效果，模拟了内容从屏幕外平滑载入的感觉，让用户能自然地感知到上下文的切换。
    - **面板展开**: `RightSearchPanel` 的展开动画是一个平滑的宽度变化，而不是瞬时出现，这帮助用户理解面板是从哪里来的，以及它与主内容区的关系。
- **微交互**:
    - **按钮点击**: 所有 MUI 按钮都内置了 Material Design 标志性的“涟漪效果” (Ripple Effect)，为用户的每一次点击提供了即时的、以点击点为中心的视觉确认。
    - **图标旋转**: `SideNav` 的折叠/展开按钮图标有一个 90 度的旋转动画，直观地表达了状态的改变。

### 3. **色彩与主题 (Color & Theming)**
- **语义化色彩**: 项目在 `theme.ts` 中定义了一套语义化的调色板 (`palette`)。`primary`, `secondary`, `error` 等颜色被统一应用在链接、主操作按钮和错误提示上，形成了一致的视觉语言，降低了用户的学习成本。
- **中性色与应用色**: 我们定义了 `neutral`（中性色）用于大部分文本和UI元素，以及 `app`（应用色）用于背景等，使得色彩系统主次分明，层次清晰。
- **一致性**: 所有组件的颜色都从 `theme.palette` 中引用，而不是硬编码。这确保了如果未来需要更换主题（例如，实现暗黑模式），只需修改 `theme.ts` 一个文件，整个应用的视觉风格就能统一更新。

### 4. **布局与响应式 (Layout & Responsiveness)**
- **断点系统**: 利用 MUI 的断点 (`breakpoints`)，`SideNav` 和 `MainLayout` 能够在桌面端和移动端之间无缝切换布局，确保在任何屏幕尺寸下都提供最佳的交互体验。
- **空间与间距**: 整个应用严格遵循 `theme.spacing` 定义的 8px 网格系统（`spacing: 4` 意味着基础单位是 4px，但 MUI 组件通常以 2 倍单位即 8px 为步进）。这使得所有元素之间的间距都和谐统一，避免了视觉上的混乱。

## 功能模块

### 主要页面
1.  **仪表盘 (Dashboard)**: 应用的欢迎页，提供快捷操作入口和关键数据概览。
2.  **服务器信息 (Servers)**: 展示服务器列表，支持**分页**、**搜索**和点击查看详情。
3.  **更新日志 (Changelog)**: 管理所有更新记录，支持按时间等多维度筛选。
4.  **巡检备份 (Inspection Backup)**: 巡检和备份任务的管理模块。
5.  **工单管理 (Tickets)**: 创建、跟踪和管理运维工单。
6.  **统计信息 (Stats)**: (规划中) 用于展示服务器资源和性能数据的分析图表。
7.  **实验功能 (Labs)**: (规划中) 用于测试和展示不稳定的新功能。
8.  **全局搜索 (Search)**: (规划中) 提供跨所有模块的统一搜索入口。
9.  **系统设置 (Settings)**: (规划中) 用于管理应用级别的配置。

## 技术栈

-   **核心框架**: React 18 + TypeScript 5
-   **UI 框架**: Material-UI (MUI) v5
-   **状态管理**:
    -   **UI 状态**: React Context API (`LayoutContext`, `NotificationContext`)
    -   **服务器状态**: TanStack Query (React Query) v5
-   **路由管理**: React Router v6
-   **动画库**: Framer Motion
-   **日期处理**: Day.js
-   **测试框架**: Jest + React Testing Library
-   **构建工具**: Vite
-   **样式方案**: MUI (Emotion) `sx` prop & `styled` API

## 项目结构

```bash
src/
├── api/                # 模拟 API 层，封装数据获取逻辑
├── components/         # 可复用组件
│   ├── forms/          # 表单组件
│   ├── modals/         # 模态框内容组件
│   ├── ui/             # 基础 UI 组件 (如 DataTable, TooltipCell)
│   └── __tests__/      # 组件的测试文件
├── contexts/           # React Context (全局状态)
├── hooks/              # 自定义 Hooks (如 useResponsiveDetailView)
├── layouts/            # 布局容器 (如 MainLayout, AppLayout)
├── pages/              # 页面级组件
│   └── mobile/         # 移动端专用的详情页面
├── utils/              # 通用工具函数 (动画、错误处理等)
│   └── __tests__/      # 工具函数的测试文件
├── theme.ts            # MUI 主题配置文件
├── App.tsx             # 应用根组件
└── main.tsx            # 应用入口文件
```

## 安装与运行

### 环境要求
Node.js >= 18.0.0  
npm 或 yarn / pnpm

### 安装步骤

```bash
# 1. 克隆项目
git clone <项目地址>

# 2. 进入项目目录
cd opsboard-web

# 3. 安装依赖
npm install

#4. 启动开发服务器
npm run dev
```
### 测试
```bash
# 运行所有测试用例
# 此命令会一次性运行所有测试，并生成报告。
npm test

# 启动交互式观察模式 (推荐)
# 此命令会进入观察模式，在您修改文件后自动重新运行相关测试。
npm test -- --watch
# 在终端中输入以下命令：
# 按 a：运行所有测试。
# 按 f：只运行上次失败的测试。
# 按 p：根据文件名筛选要运行的测试。
# 按 q：退出观察模式。
```


## 开发规范
### 代码风格
- TypeScript: 全项目强制使用，遵循严格的类型检查规则 `(strict: true)`。
- ESLint & Prettier: 自动化的代码格式化和风格检查，确保代码一致性。
- 组件写法: 统一采用现代函数式组件写法 (`const Component = (props: Props): JSX.Element => {}`)，禁止使用 `React.FC`。
- Hooks: 所有组件的副作用和状态管理逻辑，优先使用 `React Hooks` 实现。

### 特色功能
**1. URL 驱动的响应式详情视图**  
通过自定义 Hook useResponsiveDetailView，项目实现了一套优雅的详情展示逻辑：  
在桌面端，详情页以模态框形式浮现在当前列表页之上；  
在移动端，则自动重定向到专用的全屏详情页。整个过程由 URL 参数驱动，状态清晰，支持深度链接。  
**2. 健壮的跨页状态管理**  
搜索面板: 通过“责任下放”模式，让无面板的页面（如仪表盘）在加载时主动关闭全局面板，有面板的页面则监听全局状态来加载自身内容，彻底解决了跨页跳转时的状态不一致问题。
模态框: 模态框的生命周期与路由的“基础路径”绑定，切换主模块时会自动关闭，防止状态泄露。  
**3. 全局错误处理**  
渲染错误: 通过嵌套的错误边界 (Error Boundaries)，实现了两级防护。  
页面级错误只会导致内容区降级，而不会影响导航栏；  
应用级致命错误则会展示全局回退页面，确保应用永不白屏。  
**4. API & 异步错误**  
利用 TanStack Query 的全局 onError 回调和统一的 handleAsyncError 工具函数，对数据请求失败和事件处理异常进行集中捕获、记录和用户通知。

## 贡献指南
### Fork 本项目
？

## 许可证
本项目 `不知道用什么` 许可证。

## 联系方式
项目维护者: chiangho

## 特别感谢
### [Google AI Studio](https://aistudio.google.com/) 和 [Gemini 2.5 Pro 模型](https://deepmind.google/models/gemini/)
特别感谢 `Google AI Studio` 以及 `Gemini 2.5 Pro` 模型对于本项目的贡献。  
本项目是人机协作的一次深度探索，旨在验证现代大型语言模型在软件工程领域的巨大潜力`(主要还是因为我完全不会写代码)`。  
整个项目的代码库，从最初的架构设计、组件实现，到后期的复杂逻辑重构、错误处理机制的建立、自动化测试的集成。  
它不仅是代码的生产者，更是整个开发过程中的设计伙伴和问题解决者，其强大的代码理解、生成和迭代能力是本项目得以实现的核心驱动力。

### [Clarrycy](https://x.com/Clarrycy)
特别感谢 `Clarrycy` 同学在 AI 使用技巧和高级 Prompt 工程方面的无私分享。  
正是他所倡导的、与 AI 进行结构化、上下文感知和迭代式沟通的理念，极大地提升了本项目与 Gemini 模型协作的效率和产出质量。  
他所分享的工作流和思维方式，是将一个模糊的想法转化为精确、高质量代码的关键桥梁。

### [Lingma](https://lingma.aliyun.com/)
感谢`通义灵码`，为本项目编辑了所有的提交日志。  
我本想用Qwen进行开发的，但是Gemini 2.5 Pro实在是太好用了导致Lingma最后只能沦为日志生成器。  


